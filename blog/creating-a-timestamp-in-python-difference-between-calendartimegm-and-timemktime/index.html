<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Creating a timestamp in python - difference between calendar.timegm and time.mktime | Cases</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" hreflang="en" href="../../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (pl)" hreflang="pl" href="../../pl/rss.xml">
<link rel="canonical" href="http://blog.fizyk.net.pl/blog/creating-a-timestamp-in-python-difference-between-calendartimegm-and-timemktime/">
<link rel="icon" href="../../favicon.png" sizes="62x60">
<link rel="icon" href="../../favicon-speddial.png" sizes="269x262">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Grzegorz Śliwiński">
<link rel="prev" href="../measuring-test-coverage-of-pytest-plugins/" title="Measuring test coverage of py.test plugins" type="text/html">
<link rel="next" href="../running-python-tests-on-traviss-osx-workers/" title="Running python tests on Travis's OSX workers" type="text/html">
<meta property="og:site_name" content="Cases">
<meta property="og:title" content="Creating a timestamp in python - difference between calendar.timegm an">
<meta property="og:url" content="http://blog.fizyk.net.pl/blog/creating-a-timestamp-in-python-difference-between-calendartimegm-and-timemktime/">
<meta property="og:description" content="If think most of python programmers realise that there are two ways of getting timestamp with only the
help of stdlib libraries. It's time.mktime
and weirdly placed calendar.timegm.
There are two thin">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2015-11-25T20:18:16+01:00">
<meta property="article:tag" content="calendar">
<meta property="article:tag" content="performance">
<meta property="article:tag" content="python">
<meta property="article:tag" content="time">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Header and menu bar -->
<div class="container">
      <header class="blog-header py-3"><div class="row nbb-header align-items-center">
          <div class="col-md-3 col-xs-2 col-sm-2" style="width: auto;">
            <button class="navbar-toggler navbar-light bg-light nbb-navbar-toggler" type="button" data-toggle="collapse" data-target=".bs-nav-collapsible" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse bs-nav-collapsible bootblog4-search-form-holder">
                
            </div>
        </div>
          <div class="col-md-6 col-xs-10 col-sm-10 bootblog4-brand" style="width: auto;">
            <a class="navbar-brand blog-header-logo text-dark" href="../../">

            <span id="blog-title">Cases</span>
        </a>
          </div>
            <div class="col-md-3 justify-content-end align-items-center bs-nav-collapsible collapse flex-collapse bootblog4-right-nav">
            <nav class="navbar navbar-light bg-white"><ul class="navbar-nav bootblog4-right-nav">
<li class="nav-item"><a href="../../pl/" rel="alternate" hreflang="pl" class="nav-link">Polski</a></li>

                    
                    
    
    <li class="nav-item">
    <a href="index.rst" id="sourcelink" class="nav-link">Source</a>
    </li>


                    
            </ul></nav>
</div>
    </div>
</header><nav class="navbar navbar-expand-md navbar-light bg-white static-top"><div class="collapse navbar-collapse bs-nav-collapsible" id="bs-navbar">
            <ul class="navbar-nav nav-fill d-flex w-100">
<li class="nav-item">
<a href="http://www.fizyk.net.pl/en" class="nav-link">Homepage</a>
                </li>
<li class="nav-item">
<a href="../../archive/" class="nav-link">Archives</a>
                </li>
<li class="nav-item">
<a href="../../tags/" class="nav-link">Tags</a>

                
            </li>
</ul>
</div>
<!-- /.navbar-collapse -->
</nav>
</div>

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Creating a timestamp in python - difference between calendar.timegm and time.mktime</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Grzegorz Śliwiński
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2015-11-25T20:18:16+01:00" itemprop="datePublished" title="25 11 2015 20:18">25 11 2015 20:18</time></a>
            </p>
                <p class="commentline">
        
    <a href="#disqus_thread" data-disqus-identifier="cache/posts/2015-11-25-creating-a-timestamp-in-python-difference-between-calendartimegm-and-timemktime.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="index.rst" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p>If think most of python programmers realise that there are two ways of getting timestamp with only the
help of stdlib libraries. It's <a class="reference external" href="https://docs.python.org/3.5/library/time.html#time.mktime">time.mktime</a>
and weirdly placed <a class="reference external" href="https://docs.python.org/3.5/library/calendar.html#calendar.timegm">calendar.timegm</a>.</p>
<p>There are two things people are probably not aware. First one can be attributed due to the fact that
their docs are not being read properly, or more often skipped is that <strong>time.mktime</strong> function treats
timetuple as if it were representing date and time in machine local time. This means even if you
extract timetuple from your datetime object using
<a class="reference external" href="https://docs.python.org/3.5/library/datetime.html#datetime.datetime.utctimetuple">utctimetuple</a> method
resulting timestamp will still be a given date in your system local time zone. Might not be a problem
at all on production, but will be a much bigger issue on your machine, when you pull some data to analyse.
<strong>calendar.timegm</strong> on the other hand, treats all input data as if it were passed in utc.</p>
<p>Speaking of which, none of those two functions accepts a parameter that would tell which timezone the
timetuple is in. The only difference is that <strong>time.mktime</strong> returns a float and <strong>calendar.timegm</strong>
returns an integer.</p>
<p>Second things - timegm function is faster than mktime! See the short benchmarks below:</p>
<!-- TEASER_END -->
<p>Results on python 3.5:</p>
<pre class="code python"><a id="rest_code_83f894a0df084db6a17d2bb4df539ad3-1" name="rest_code_83f894a0df084db6a17d2bb4df539ad3-1"></a><span class="n">In</span> <span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="n">time</span><span class="o">.</span><span class="n">mktime</span><span class="p">(</span><span class="n">timetuple</span><span class="p">)</span>
<a id="rest_code_83f894a0df084db6a17d2bb4df539ad3-2" name="rest_code_83f894a0df084db6a17d2bb4df539ad3-2"></a><span class="n">The</span> <span class="n">slowest</span> <span class="n">run</span> <span class="n">took</span> <span class="mf">32.44</span> <span class="n">times</span> <span class="n">longer</span> <span class="n">than</span> <span class="n">the</span> <span class="n">fastest</span><span class="o">.</span> <span class="n">This</span> <span class="n">could</span> <span class="n">mean</span> <span class="n">that</span> <span class="n">an</span> <span class="n">intermediate</span> <span class="n">result</span> <span class="ow">is</span> <span class="n">being</span> <span class="n">cached</span>
<a id="rest_code_83f894a0df084db6a17d2bb4df539ad3-3" name="rest_code_83f894a0df084db6a17d2bb4df539ad3-3"></a><span class="mi">1000000</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">938</span> <span class="n">ns</span> <span class="n">per</span> <span class="n">loop</span>
<a id="rest_code_83f894a0df084db6a17d2bb4df539ad3-4" name="rest_code_83f894a0df084db6a17d2bb4df539ad3-4"></a>
<a id="rest_code_83f894a0df084db6a17d2bb4df539ad3-5" name="rest_code_83f894a0df084db6a17d2bb4df539ad3-5"></a><span class="n">In</span> <span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="n">calendar</span><span class="o">.</span><span class="n">timegm</span><span class="p">(</span><span class="n">timetuple</span><span class="p">)</span>
<a id="rest_code_83f894a0df084db6a17d2bb4df539ad3-6" name="rest_code_83f894a0df084db6a17d2bb4df539ad3-6"></a><span class="n">The</span> <span class="n">slowest</span> <span class="n">run</span> <span class="n">took</span> <span class="mf">20.75</span> <span class="n">times</span> <span class="n">longer</span> <span class="n">than</span> <span class="n">the</span> <span class="n">fastest</span><span class="o">.</span> <span class="n">This</span> <span class="n">could</span> <span class="n">mean</span> <span class="n">that</span> <span class="n">an</span> <span class="n">intermediate</span> <span class="n">result</span> <span class="ow">is</span> <span class="n">being</span> <span class="n">cached</span>
<a id="rest_code_83f894a0df084db6a17d2bb4df539ad3-7" name="rest_code_83f894a0df084db6a17d2bb4df539ad3-7"></a><span class="mi">1000000</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">817</span> <span class="n">ns</span> <span class="n">per</span> <span class="n">loop</span>
</pre>
<p>And even faster on python 2.7:</p>
<pre class="code python"><a id="rest_code_94b7833c1bd040b7abffd0bafc11ab8e-1" name="rest_code_94b7833c1bd040b7abffd0bafc11ab8e-1"></a><span class="n">In</span> <span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="n">time</span><span class="o">.</span><span class="n">mktime</span><span class="p">(</span><span class="n">timetuple</span><span class="p">)</span>
<a id="rest_code_94b7833c1bd040b7abffd0bafc11ab8e-2" name="rest_code_94b7833c1bd040b7abffd0bafc11ab8e-2"></a><span class="n">The</span> <span class="n">slowest</span> <span class="n">run</span> <span class="n">took</span> <span class="mf">35.25</span> <span class="n">times</span> <span class="n">longer</span> <span class="n">than</span> <span class="n">the</span> <span class="n">fastest</span><span class="o">.</span> <span class="n">This</span> <span class="n">could</span> <span class="n">mean</span> <span class="n">that</span> <span class="n">an</span> <span class="n">intermediate</span> <span class="n">result</span> <span class="ow">is</span> <span class="n">being</span> <span class="n">cached</span>
<a id="rest_code_94b7833c1bd040b7abffd0bafc11ab8e-3" name="rest_code_94b7833c1bd040b7abffd0bafc11ab8e-3"></a><span class="mi">1000000</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">906</span> <span class="n">ns</span> <span class="n">per</span> <span class="n">loop</span>
<a id="rest_code_94b7833c1bd040b7abffd0bafc11ab8e-4" name="rest_code_94b7833c1bd040b7abffd0bafc11ab8e-4"></a>
<a id="rest_code_94b7833c1bd040b7abffd0bafc11ab8e-5" name="rest_code_94b7833c1bd040b7abffd0bafc11ab8e-5"></a><span class="n">In</span> <span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="n">calendar</span><span class="o">.</span><span class="n">timegm</span><span class="p">(</span><span class="n">timetuple</span><span class="p">)</span>
<a id="rest_code_94b7833c1bd040b7abffd0bafc11ab8e-6" name="rest_code_94b7833c1bd040b7abffd0bafc11ab8e-6"></a><span class="n">The</span> <span class="n">slowest</span> <span class="n">run</span> <span class="n">took</span> <span class="mf">24.31</span> <span class="n">times</span> <span class="n">longer</span> <span class="n">than</span> <span class="n">the</span> <span class="n">fastest</span><span class="o">.</span> <span class="n">This</span> <span class="n">could</span> <span class="n">mean</span> <span class="n">that</span> <span class="n">an</span> <span class="n">intermediate</span> <span class="n">result</span> <span class="ow">is</span> <span class="n">being</span> <span class="n">cached</span>
<a id="rest_code_94b7833c1bd040b7abffd0bafc11ab8e-7" name="rest_code_94b7833c1bd040b7abffd0bafc11ab8e-7"></a><span class="mi">1000000</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">579</span> <span class="n">ns</span> <span class="n">per</span> <span class="n">loop</span>
</pre>
<p>There seems to be some performance regression for timegm on python 3, but it's still a bit faster than mktime.</p>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../tags/calendar/" rel="tag">calendar</a></li>
            <li><a class="tag p-category" href="../../tags/performance/" rel="tag">performance</a></li>
            <li><a class="tag p-category" href="../../tags/python/" rel="tag">python</a></li>
            <li><a class="tag p-category" href="../../tags/time/" rel="tag">time</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../measuring-test-coverage-of-pytest-plugins/" rel="prev" title="Measuring test coverage of py.test plugins">Previous post</a>
            </li>
            <li class="next">
                <a href="../running-python-tests-on-traviss-osx-workers/" rel="next" title="Running python tests on Travis's OSX workers">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="casesblog",
            disqus_url="http://blog.fizyk.net.pl/blog/creating-a-timestamp-in-python-difference-between-calendartimegm-and-timemktime/",
        disqus_title="Creating a timestamp in python - difference between calendar.timegm and time.mktime",
        disqus_identifier="cache/posts/2015-11-25-creating-a-timestamp-in-python-difference-between-calendartimegm-and-timemktime.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="casesblog";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><!--End of body content--><footer id="footer">
            Contents © 2021 <a href="mailto:fizyk~~fizyk.net.pl">Grzegorz Śliwiński</a> - Powered by <a href="http://nikola.ralsina.com.ar">Nikola</a>
            
            
        </footer>
</div>
</div>


        <script src="../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-20536007-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>
