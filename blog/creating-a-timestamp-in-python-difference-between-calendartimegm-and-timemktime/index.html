<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Creating a timestamp in python - difference between calendar.timegm and time.mktime | Cases</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="../../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (pl)" href="../../pl/rss.xml">
<link rel="canonical" href="http://blog.fizyk.net.pl/blog/creating-a-timestamp-in-python-difference-between-calendartimegm-and-timemktime/">
<link rel="icon" href="../../favicon.png" sizes="62x60">
<link rel="icon" href="../../favicon-speddial.png" sizes="269x262">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]-->
</head>
<body class="home blog">
    <div id="wrap" style="width:850px">
        <div id="container" style="width:560px">
            
            
    <div class="post">
    
    <h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Creating a timestamp in python - difference between calendar.timegm and time.mktime</a></h1>

        <div class="meta" style="background-color: rgb(234, 234, 234); ">
        <span class="authordate">
            Posted: <time class="published" datetime="2015-11-25T20:18:16+01:00">25 11 2015 20:18</time>
               [<a href="index.rst" id="sourcelink">Source</a>]
        </span>
        <br><span class="tags">Tags:Â 
                    <a class="tag" href="../../tags/calendar/"><span>calendar</span></a>
                    <a class="tag" href="../../tags/performance/"><span>performance</span></a>
                    <a class="tag" href="../../tags/python/"><span>python</span></a>
                    <a class="tag" href="../../tags/time/"><span>time</span></a>
                </span>
                <br><span class="authordate">
            

        </span>
        </div>
    <div>
<p>If think most of python programmers realise that there are two ways of getting timestamp with only the
help of stdlib libraries. It's <a class="reference external" href="https://docs.python.org/3.5/library/time.html#time.mktime">time.mktime</a>
and weirdly placed <a class="reference external" href="https://docs.python.org/3.5/library/calendar.html#calendar.timegm">calendar.timegm</a>.</p>
<p>There are two things people are probably not aware. First one can be attributed due to the fact that
their docs are not being read properly, or more often skipped is that <strong>time.mktime</strong> function treats
timetuple as if it were representing date and time in machine local time. This means even if you
extract timetuple from your datetime object using
<a class="reference external" href="https://docs.python.org/3.5/library/datetime.html#datetime.datetime.utctimetuple">utctimetuple</a> method
resulting timestamp will still be a given date in your system local time zone. Might not be a problem
at all on production, but will be a much bigger issue on your machine, when you pull some data to analyse.
<strong>calendar.timegm</strong> on the other hand, treats all input data as if it were passed in utc.</p>
<p>Speaking of which, none of those two functions accepts a parameter that would tell which timezone the
timetuple is in. The only difference is that <strong>time.mktime</strong> returns a float and <strong>calendar.timegm</strong>
returns an integer.</p>
<p>Second things - timegm function is faster than mktime! See the short benchmarks below:</p>
<!-- TEASER_END -->
<p>Results on python 3.5:</p>
<pre class="code python"><a id="rest_code_f41144655b834730a738910e6a8143f2-1" name="rest_code_f41144655b834730a738910e6a8143f2-1"></a><span class="n">In</span> <span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="n">time</span><span class="o">.</span><span class="n">mktime</span><span class="p">(</span><span class="n">timetuple</span><span class="p">)</span>
<a id="rest_code_f41144655b834730a738910e6a8143f2-2" name="rest_code_f41144655b834730a738910e6a8143f2-2"></a><span class="n">The</span> <span class="n">slowest</span> <span class="n">run</span> <span class="n">took</span> <span class="mf">32.44</span> <span class="n">times</span> <span class="n">longer</span> <span class="n">than</span> <span class="n">the</span> <span class="n">fastest</span><span class="o">.</span> <span class="n">This</span> <span class="n">could</span> <span class="n">mean</span> <span class="n">that</span> <span class="n">an</span> <span class="n">intermediate</span> <span class="n">result</span> <span class="ow">is</span> <span class="n">being</span> <span class="n">cached</span>
<a id="rest_code_f41144655b834730a738910e6a8143f2-3" name="rest_code_f41144655b834730a738910e6a8143f2-3"></a><span class="mi">1000000</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">938</span> <span class="n">ns</span> <span class="n">per</span> <span class="n">loop</span>
<a id="rest_code_f41144655b834730a738910e6a8143f2-4" name="rest_code_f41144655b834730a738910e6a8143f2-4"></a>
<a id="rest_code_f41144655b834730a738910e6a8143f2-5" name="rest_code_f41144655b834730a738910e6a8143f2-5"></a><span class="n">In</span> <span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="n">calendar</span><span class="o">.</span><span class="n">timegm</span><span class="p">(</span><span class="n">timetuple</span><span class="p">)</span>
<a id="rest_code_f41144655b834730a738910e6a8143f2-6" name="rest_code_f41144655b834730a738910e6a8143f2-6"></a><span class="n">The</span> <span class="n">slowest</span> <span class="n">run</span> <span class="n">took</span> <span class="mf">20.75</span> <span class="n">times</span> <span class="n">longer</span> <span class="n">than</span> <span class="n">the</span> <span class="n">fastest</span><span class="o">.</span> <span class="n">This</span> <span class="n">could</span> <span class="n">mean</span> <span class="n">that</span> <span class="n">an</span> <span class="n">intermediate</span> <span class="n">result</span> <span class="ow">is</span> <span class="n">being</span> <span class="n">cached</span>
<a id="rest_code_f41144655b834730a738910e6a8143f2-7" name="rest_code_f41144655b834730a738910e6a8143f2-7"></a><span class="mi">1000000</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">817</span> <span class="n">ns</span> <span class="n">per</span> <span class="n">loop</span>
</pre>
<p>And even faster on python 2.7:</p>
<pre class="code python"><a id="rest_code_9d1d8b56572641f1a0f2c37c50daf9c6-1" name="rest_code_9d1d8b56572641f1a0f2c37c50daf9c6-1"></a><span class="n">In</span> <span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="n">time</span><span class="o">.</span><span class="n">mktime</span><span class="p">(</span><span class="n">timetuple</span><span class="p">)</span>
<a id="rest_code_9d1d8b56572641f1a0f2c37c50daf9c6-2" name="rest_code_9d1d8b56572641f1a0f2c37c50daf9c6-2"></a><span class="n">The</span> <span class="n">slowest</span> <span class="n">run</span> <span class="n">took</span> <span class="mf">35.25</span> <span class="n">times</span> <span class="n">longer</span> <span class="n">than</span> <span class="n">the</span> <span class="n">fastest</span><span class="o">.</span> <span class="n">This</span> <span class="n">could</span> <span class="n">mean</span> <span class="n">that</span> <span class="n">an</span> <span class="n">intermediate</span> <span class="n">result</span> <span class="ow">is</span> <span class="n">being</span> <span class="n">cached</span>
<a id="rest_code_9d1d8b56572641f1a0f2c37c50daf9c6-3" name="rest_code_9d1d8b56572641f1a0f2c37c50daf9c6-3"></a><span class="mi">1000000</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">906</span> <span class="n">ns</span> <span class="n">per</span> <span class="n">loop</span>
<a id="rest_code_9d1d8b56572641f1a0f2c37c50daf9c6-4" name="rest_code_9d1d8b56572641f1a0f2c37c50daf9c6-4"></a>
<a id="rest_code_9d1d8b56572641f1a0f2c37c50daf9c6-5" name="rest_code_9d1d8b56572641f1a0f2c37c50daf9c6-5"></a><span class="n">In</span> <span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="n">calendar</span><span class="o">.</span><span class="n">timegm</span><span class="p">(</span><span class="n">timetuple</span><span class="p">)</span>
<a id="rest_code_9d1d8b56572641f1a0f2c37c50daf9c6-6" name="rest_code_9d1d8b56572641f1a0f2c37c50daf9c6-6"></a><span class="n">The</span> <span class="n">slowest</span> <span class="n">run</span> <span class="n">took</span> <span class="mf">24.31</span> <span class="n">times</span> <span class="n">longer</span> <span class="n">than</span> <span class="n">the</span> <span class="n">fastest</span><span class="o">.</span> <span class="n">This</span> <span class="n">could</span> <span class="n">mean</span> <span class="n">that</span> <span class="n">an</span> <span class="n">intermediate</span> <span class="n">result</span> <span class="ow">is</span> <span class="n">being</span> <span class="n">cached</span>
<a id="rest_code_9d1d8b56572641f1a0f2c37c50daf9c6-7" name="rest_code_9d1d8b56572641f1a0f2c37c50daf9c6-7"></a><span class="mi">1000000</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">579</span> <span class="n">ns</span> <span class="n">per</span> <span class="n">loop</span>
</pre>
<p>There seems to be some performance regression for timegm on python 3, but it's still a bit faster than mktime.</p>
</div>
    
        <ul class="pager hidden-print">
<li class="previous">
                <a href="../measuring-test-coverage-of-pytest-plugins/" rel="prev" title="Measuring test coverage of py.test plugins">Previous post</a>
            </li>
            <li class="next">
                <a href="../running-python-tests-on-traviss-osx-workers/" rel="next" title="Running python tests on Travis's OSX workers">Next post</a>
            </li>
        </ul>
<div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="casesblog",
            disqus_url="http://blog.fizyk.net.pl/blog/creating-a-timestamp-in-python-difference-between-calendartimegm-and-timemktime/",
        disqus_title="Creating a timestamp in python - difference between calendar.timegm and time.mktime",
        disqus_identifier="cache/posts/2015-11-25-creating-a-timestamp-in-python-difference-between-calendartimegm-and-timemktime.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


    

    </div>

        </div>
        <div id="sidebar">
            <!--Sidebar content-->
            <h1 id="blog-title">
                <a href="http://blog.fizyk.net.pl/" title="Cases">Cases</a>
            </h1>
            
            <small>
                Also available in:Â 
                
            <li><a href="http://blog.fizyk.net.pl/pl/" rel="alternate" hreflang="pl">Polski</a></li>

            </small>
            
            <ul class="unstyled">
<li>
<a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.pl">
    <img alt="Licencja Creative Commons" style="border-width:0" src="http://i.creativecommons.org/l/by/3.0/88x31.png"></a>
<br>Ten utwÃ³r, autorstwa
<span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">
    Grzegorz ÅliwiÅski</span>
jest dostÄpny na licencji
<a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.pl">
    Creative Commons Uznanie autorstwa 3.0 Unported
</a>.</li>
            
                <li>
<a href="http://www.fizyk.net.pl/en">Homepage</a>
                </li>
<li>
<a href="../../archive/">Archives</a>
                </li>
<li>
<a href="../../tags/">Tags</a>

            </li>
<li>
            
            
            </ul>
</div>
        <div id="footer">
            Contents Â© 2021 <a href="mailto:fizyk~~fizyk.net.pl">Grzegorz ÅliwiÅski</a> - Powered by <a href="http://nikola.ralsina.com.ar">Nikola</a>
            
        </div>
    </div>
    
            <script src="../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-20536007-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>
