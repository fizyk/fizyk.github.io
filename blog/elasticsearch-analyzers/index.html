<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Elasticsearch analyzers | Cases</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" hreflang="en" href="../../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (pl)" hreflang="pl" href="../../pl/rss.xml">
<link rel="canonical" href="http://blog.fizyk.net.pl/blog/elasticsearch-analyzers/">
<link rel="icon" href="../../favicon.png" sizes="62x60">
<link rel="icon" href="../../favicon-speddial.png" sizes="269x262">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Grzegorz Śliwiński">
<link rel="prev" href="../pylama-python-developers-helpful-companion/" title="Pylama - Python developer's helpful companion" type="text/html">
<link rel="next" href="../testing-web-applications-using-sqlalchemy/" title="Testing web applications using SQLAlchemy." type="text/html">
<meta property="og:site_name" content="Cases">
<meta property="og:title" content="Elasticsearch analyzers">
<meta property="og:url" content="http://blog.fizyk.net.pl/blog/elasticsearch-analyzers/">
<meta property="og:description" content="Elasticsearch is all the buzzwords recently.
There are projects using it to fast distributed search, as a document database
and as a tool for data analysis. I've wanted to check out Elasticsearch for
">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2014-03-11T22:14:06+01:00">
<meta property="article:tag" content="elasticsearch">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Header and menu bar -->
<div class="container">
      <header class="blog-header py-3"><div class="row nbb-header align-items-center">
          <div class="col-md-3 col-xs-2 col-sm-2" style="width: auto;">
            <button class="navbar-toggler navbar-light bg-light nbb-navbar-toggler" type="button" data-toggle="collapse" data-target=".bs-nav-collapsible" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse bs-nav-collapsible bootblog4-search-form-holder">
                
            </div>
        </div>
          <div class="col-md-6 col-xs-10 col-sm-10 bootblog4-brand" style="width: auto;">
            <a class="navbar-brand blog-header-logo text-dark" href="../../">

            <span id="blog-title">Cases</span>
        </a>
          </div>
            <div class="col-md-3 justify-content-end align-items-center bs-nav-collapsible collapse flex-collapse bootblog4-right-nav">
            <nav class="navbar navbar-light bg-white"><ul class="navbar-nav bootblog4-right-nav">
<li class="nav-item"><a href="../../pl/" rel="alternate" hreflang="pl" class="nav-link">Polski</a></li>

                    
                    
    
    <li class="nav-item">
    <a href="index.rst" id="sourcelink" class="nav-link">Source</a>
    </li>


                    
            </ul></nav>
</div>
    </div>
</header><nav class="navbar navbar-expand-md navbar-light bg-white static-top"><div class="collapse navbar-collapse bs-nav-collapsible" id="bs-navbar">
            <ul class="navbar-nav nav-fill d-flex w-100">
<li class="nav-item">
<a href="http://www.fizyk.net.pl/en" class="nav-link">Homepage</a>
                </li>
<li class="nav-item">
<a href="../../archive/" class="nav-link">Archives</a>
                </li>
<li class="nav-item">
<a href="../../tags/" class="nav-link">Tags</a>

                
            </li>
</ul>
</div>
<!-- /.navbar-collapse -->
</nav>
</div>

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Elasticsearch analyzers</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Grzegorz Śliwiński
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2014-03-11T22:14:06+01:00" itemprop="datePublished" title="11 3 2014 22:14">11 3 2014 22:14</time></a>
            </p>
                <p class="commentline">
        
    <a href="#disqus_thread" data-disqus-identifier="cache/posts/2014-03-11-elasticsearch-analyzers.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="index.rst" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p><a class="reference external" href="http://www.elasticsearch.org/">Elasticsearch</a> is all the buzzwords recently.
There are projects using it to fast distributed search, as a document database
and as a tool for data analysis. I've wanted to check out Elasticsearch for
some time already, even more, since I've been at <a class="reference external" href="https://www.youtube.com/watch?v=yZu4jQtBUPg">lecture about aggregations
in Elasticsearch</a>
by <strong>Honza Král</strong> at PyConPL 2013 . I recently got a chance to check it out
migrating project from whoosh to elasticsearch. And first thing I noticed about
Elasticsearch from solutions I've been using so far are analyzers.</p>
<!-- TEASER_END -->
<p>Unlike <strong>Sphinx</strong> or <strong>Whoosh</strong>, where you determine how to analyze a field
by search engine, in Elasticsearch, you define an <strong>analyzer</strong> for a field
to analyze both the field, and query for the field as well.</p>
<pre class="code json"><a id="rest_code_566aa7a903db4653b1641adfe52def6e-1" name="rest_code_566aa7a903db4653b1641adfe52def6e-1"></a><span class="p">{</span>
<a id="rest_code_566aa7a903db4653b1641adfe52def6e-2" name="rest_code_566aa7a903db4653b1641adfe52def6e-2"></a>    <span class="nt">"mappings"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_566aa7a903db4653b1641adfe52def6e-3" name="rest_code_566aa7a903db4653b1641adfe52def6e-3"></a>        <span class="nt">"document"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_566aa7a903db4653b1641adfe52def6e-4" name="rest_code_566aa7a903db4653b1641adfe52def6e-4"></a>            <span class="nt">"properties"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_566aa7a903db4653b1641adfe52def6e-5" name="rest_code_566aa7a903db4653b1641adfe52def6e-5"></a>                <span class="nt">"title"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_566aa7a903db4653b1641adfe52def6e-6" name="rest_code_566aa7a903db4653b1641adfe52def6e-6"></a>                    <span class="nt">"type"</span><span class="p">:</span> <span class="s2">"string"</span><span class="p">,</span>
<a id="rest_code_566aa7a903db4653b1641adfe52def6e-7" name="rest_code_566aa7a903db4653b1641adfe52def6e-7"></a>                    <span class="nt">"analyzer"</span><span class="p">:</span> <span class="s2">"autocomplete_analyzer"</span><span class="p">,</span>
<a id="rest_code_566aa7a903db4653b1641adfe52def6e-8" name="rest_code_566aa7a903db4653b1641adfe52def6e-8"></a>                <span class="p">}</span>
<a id="rest_code_566aa7a903db4653b1641adfe52def6e-9" name="rest_code_566aa7a903db4653b1641adfe52def6e-9"></a>            <span class="p">}</span>
<a id="rest_code_566aa7a903db4653b1641adfe52def6e-10" name="rest_code_566aa7a903db4653b1641adfe52def6e-10"></a>        <span class="p">}</span>
<a id="rest_code_566aa7a903db4653b1641adfe52def6e-11" name="rest_code_566aa7a903db4653b1641adfe52def6e-11"></a>    <span class="p">}</span>
<a id="rest_code_566aa7a903db4653b1641adfe52def6e-12" name="rest_code_566aa7a903db4653b1641adfe52def6e-12"></a><span class="p">}</span>
</pre>
<p>This mapping definition will cause Elasticsearch to index title field according
to autocomplete_analyzer and query as well. That's fine for most cases,
but eg. for autocomplete usually tries to suggest where user can go further
from what he typed, not what else he might have typed in.</p>
<p>Elasticsearch provides a possibility to define separate analyzer
<strong>index_analyzer</strong> for index and <strong>search_analyzer</strong> for search query.</p>
<pre class="code json"><a id="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-1" name="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-1"></a><span class="p">{</span>
<a id="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-2" name="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-2"></a>    <span class="nt">"mappings"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-3" name="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-3"></a>        <span class="nt">"document"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-4" name="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-4"></a>            <span class="nt">"properties"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-5" name="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-5"></a>                <span class="nt">"title"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-6" name="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-6"></a>                    <span class="nt">"type"</span><span class="p">:</span> <span class="s2">"string"</span><span class="p">,</span>
<a id="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-7" name="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-7"></a>                    <span class="nt">"index_analyzer"</span><span class="p">:</span> <span class="s2">"autocomplete_analyzer"</span><span class="p">,</span>
<a id="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-8" name="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-8"></a>                    <span class="nt">"search_analyzer"</span><span class="p">:</span> <span class="s2">"simple"</span>
<a id="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-9" name="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-9"></a>                <span class="p">}</span>
<a id="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-10" name="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-10"></a>            <span class="p">}</span>
<a id="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-11" name="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-11"></a>        <span class="p">}</span>
<a id="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-12" name="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-12"></a>    <span class="p">}</span>
<a id="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-13" name="rest_code_7ac2ed7c92e94bba9d3533c44b9386f5-13"></a><span class="p">}</span>
</pre>
<p>This will allow to limit suggestions to take account whole words user has
already typed in. There's one caveat though. If you leave also the default
analyzer definition, elasticsearch won't take into account <em>index_analyzer</em>
and <em>search_analyzer,</em> but will create an additional <strong>search_query_analyzer</strong>.
And this, at least for me, haven't returned the results I expected.</p>
<p>Of course, if you standard analyzers won't be what you seek, there's always an
option to define custom analyzers, custom tokenizers, and custom filters.</p>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../tags/elasticsearch/" rel="tag">elasticsearch</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../pylama-python-developers-helpful-companion/" rel="prev" title="Pylama - Python developer's helpful companion">Previous post</a>
            </li>
            <li class="next">
                <a href="../testing-web-applications-using-sqlalchemy/" rel="next" title="Testing web applications using SQLAlchemy.">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="casesblog",
            disqus_url="http://blog.fizyk.net.pl/blog/elasticsearch-analyzers/",
        disqus_title="Elasticsearch analyzers",
        disqus_identifier="cache/posts/2014-03-11-elasticsearch-analyzers.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="casesblog";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><!--End of body content--><footer id="footer">
            Contents © 2021 <a href="mailto:fizyk~~fizyk.net.pl">Grzegorz Śliwiński</a> - Powered by <a href="http://nikola.ralsina.com.ar">Nikola</a>
            
            
        </footer>
</div>
</div>


        <script src="../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-20536007-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>
