<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Elasticsearch analyzers | Cases</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="../../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (pl)" href="../../pl/rss.xml">
<link rel="canonical" href="https://fizyk.dev/blog/elasticsearch-analyzers/">
<link rel="icon" href="../../favicon-speddial.png" sizes="269x262">
<link rel="icon" href="../../favicon.png" sizes="62x60">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]-->
</head>
<body class="home blog">
    <div id="wrap" style="width:850px">
        <div id="container" style="width:560px">
            
            
    <div class="post">
    
    <h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Elasticsearch analyzers</a></h1>

        <div class="meta" style="background-color: rgb(234, 234, 234); ">
        <span class="authordate">
            Posted: <time class="published" datetime="2014-03-11T22:14:06+01:00">11 3 2014 22:14</time>
               [<a href="index.rst" id="sourcelink">Source</a>]
        </span>
        <br><span class="tags">Tags: 
                    <a class="tag" href="../../tags/elasticsearch/"><span>elasticsearch</span></a>
                </span>
                <br><span class="authordate">
            

        </span>
        </div>
    <p><a class="reference external" href="http://www.elasticsearch.org/">Elasticsearch</a> is all the buzzwords recently.
There are projects using it to fast distributed search, as a document database
and as a tool for data analysis. I've wanted to check out Elasticsearch for
some time already, even more, since I've been at <a class="reference external" href="https://www.youtube.com/watch?v=yZu4jQtBUPg">lecture about aggregations
in Elasticsearch</a>
by <strong>Honza Král</strong> at PyConPL 2013 . I recently got a chance to check it out
migrating project from whoosh to elasticsearch. And first thing I noticed about
Elasticsearch from solutions I've been using so far are analyzers.</p>
<!-- TEASER_END -->
<p>Unlike <strong>Sphinx</strong> or <strong>Whoosh</strong>, where you determine how to analyze a field
by search engine, in Elasticsearch, you define an <strong>analyzer</strong> for a field
to analyze both the field, and query for the field as well.</p>
<div class="code"><pre class="code json"><a id="rest_code_8765dbe209ce47ec9e2b282a4adbf451-1" name="rest_code_8765dbe209ce47ec9e2b282a4adbf451-1" href="#rest_code_8765dbe209ce47ec9e2b282a4adbf451-1"></a><span class="p">{</span>
<a id="rest_code_8765dbe209ce47ec9e2b282a4adbf451-2" name="rest_code_8765dbe209ce47ec9e2b282a4adbf451-2" href="#rest_code_8765dbe209ce47ec9e2b282a4adbf451-2"></a><span class="w">    </span><span class="nt">"mappings"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="rest_code_8765dbe209ce47ec9e2b282a4adbf451-3" name="rest_code_8765dbe209ce47ec9e2b282a4adbf451-3" href="#rest_code_8765dbe209ce47ec9e2b282a4adbf451-3"></a><span class="w">        </span><span class="nt">"document"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="rest_code_8765dbe209ce47ec9e2b282a4adbf451-4" name="rest_code_8765dbe209ce47ec9e2b282a4adbf451-4" href="#rest_code_8765dbe209ce47ec9e2b282a4adbf451-4"></a><span class="w">            </span><span class="nt">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="rest_code_8765dbe209ce47ec9e2b282a4adbf451-5" name="rest_code_8765dbe209ce47ec9e2b282a4adbf451-5" href="#rest_code_8765dbe209ce47ec9e2b282a4adbf451-5"></a><span class="w">                </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="rest_code_8765dbe209ce47ec9e2b282a4adbf451-6" name="rest_code_8765dbe209ce47ec9e2b282a4adbf451-6" href="#rest_code_8765dbe209ce47ec9e2b282a4adbf451-6"></a><span class="w">                    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span>
<a id="rest_code_8765dbe209ce47ec9e2b282a4adbf451-7" name="rest_code_8765dbe209ce47ec9e2b282a4adbf451-7" href="#rest_code_8765dbe209ce47ec9e2b282a4adbf451-7"></a><span class="w">                    </span><span class="nt">"analyzer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"autocomplete_analyzer"</span><span class="p">,</span>
<a id="rest_code_8765dbe209ce47ec9e2b282a4adbf451-8" name="rest_code_8765dbe209ce47ec9e2b282a4adbf451-8" href="#rest_code_8765dbe209ce47ec9e2b282a4adbf451-8"></a><span class="w">                </span><span class="p">}</span>
<a id="rest_code_8765dbe209ce47ec9e2b282a4adbf451-9" name="rest_code_8765dbe209ce47ec9e2b282a4adbf451-9" href="#rest_code_8765dbe209ce47ec9e2b282a4adbf451-9"></a><span class="w">            </span><span class="p">}</span>
<a id="rest_code_8765dbe209ce47ec9e2b282a4adbf451-10" name="rest_code_8765dbe209ce47ec9e2b282a4adbf451-10" href="#rest_code_8765dbe209ce47ec9e2b282a4adbf451-10"></a><span class="w">        </span><span class="p">}</span>
<a id="rest_code_8765dbe209ce47ec9e2b282a4adbf451-11" name="rest_code_8765dbe209ce47ec9e2b282a4adbf451-11" href="#rest_code_8765dbe209ce47ec9e2b282a4adbf451-11"></a><span class="w">    </span><span class="p">}</span>
<a id="rest_code_8765dbe209ce47ec9e2b282a4adbf451-12" name="rest_code_8765dbe209ce47ec9e2b282a4adbf451-12" href="#rest_code_8765dbe209ce47ec9e2b282a4adbf451-12"></a><span class="p">}</span>
</pre></div>
<p>This mapping definition will cause Elasticsearch to index title field according
to autocomplete_analyzer and query as well. That's fine for most cases,
but eg. for autocomplete usually tries to suggest where user can go further
from what he typed, not what else he might have typed in.</p>
<p>Elasticsearch provides a possibility to define separate analyzer
<strong>index_analyzer</strong> for index and <strong>search_analyzer</strong> for search query.</p>
<div class="code"><pre class="code json"><a id="rest_code_5a5168f89b8947e9bf9f5085f471cddf-1" name="rest_code_5a5168f89b8947e9bf9f5085f471cddf-1" href="#rest_code_5a5168f89b8947e9bf9f5085f471cddf-1"></a><span class="p">{</span>
<a id="rest_code_5a5168f89b8947e9bf9f5085f471cddf-2" name="rest_code_5a5168f89b8947e9bf9f5085f471cddf-2" href="#rest_code_5a5168f89b8947e9bf9f5085f471cddf-2"></a><span class="w">    </span><span class="nt">"mappings"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="rest_code_5a5168f89b8947e9bf9f5085f471cddf-3" name="rest_code_5a5168f89b8947e9bf9f5085f471cddf-3" href="#rest_code_5a5168f89b8947e9bf9f5085f471cddf-3"></a><span class="w">        </span><span class="nt">"document"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="rest_code_5a5168f89b8947e9bf9f5085f471cddf-4" name="rest_code_5a5168f89b8947e9bf9f5085f471cddf-4" href="#rest_code_5a5168f89b8947e9bf9f5085f471cddf-4"></a><span class="w">            </span><span class="nt">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="rest_code_5a5168f89b8947e9bf9f5085f471cddf-5" name="rest_code_5a5168f89b8947e9bf9f5085f471cddf-5" href="#rest_code_5a5168f89b8947e9bf9f5085f471cddf-5"></a><span class="w">                </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="rest_code_5a5168f89b8947e9bf9f5085f471cddf-6" name="rest_code_5a5168f89b8947e9bf9f5085f471cddf-6" href="#rest_code_5a5168f89b8947e9bf9f5085f471cddf-6"></a><span class="w">                    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span>
<a id="rest_code_5a5168f89b8947e9bf9f5085f471cddf-7" name="rest_code_5a5168f89b8947e9bf9f5085f471cddf-7" href="#rest_code_5a5168f89b8947e9bf9f5085f471cddf-7"></a><span class="w">                    </span><span class="nt">"index_analyzer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"autocomplete_analyzer"</span><span class="p">,</span>
<a id="rest_code_5a5168f89b8947e9bf9f5085f471cddf-8" name="rest_code_5a5168f89b8947e9bf9f5085f471cddf-8" href="#rest_code_5a5168f89b8947e9bf9f5085f471cddf-8"></a><span class="w">                    </span><span class="nt">"search_analyzer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"simple"</span>
<a id="rest_code_5a5168f89b8947e9bf9f5085f471cddf-9" name="rest_code_5a5168f89b8947e9bf9f5085f471cddf-9" href="#rest_code_5a5168f89b8947e9bf9f5085f471cddf-9"></a><span class="w">                </span><span class="p">}</span>
<a id="rest_code_5a5168f89b8947e9bf9f5085f471cddf-10" name="rest_code_5a5168f89b8947e9bf9f5085f471cddf-10" href="#rest_code_5a5168f89b8947e9bf9f5085f471cddf-10"></a><span class="w">            </span><span class="p">}</span>
<a id="rest_code_5a5168f89b8947e9bf9f5085f471cddf-11" name="rest_code_5a5168f89b8947e9bf9f5085f471cddf-11" href="#rest_code_5a5168f89b8947e9bf9f5085f471cddf-11"></a><span class="w">        </span><span class="p">}</span>
<a id="rest_code_5a5168f89b8947e9bf9f5085f471cddf-12" name="rest_code_5a5168f89b8947e9bf9f5085f471cddf-12" href="#rest_code_5a5168f89b8947e9bf9f5085f471cddf-12"></a><span class="w">    </span><span class="p">}</span>
<a id="rest_code_5a5168f89b8947e9bf9f5085f471cddf-13" name="rest_code_5a5168f89b8947e9bf9f5085f471cddf-13" href="#rest_code_5a5168f89b8947e9bf9f5085f471cddf-13"></a><span class="p">}</span>
</pre></div>
<p>This will allow to limit suggestions to take account whole words user has
already typed in. There's one caveat though. If you leave also the default
analyzer definition, elasticsearch won't take into account <em>index_analyzer</em>
and <em>search_analyzer,</em> but will create an additional <strong>search_query_analyzer</strong>.
And this, at least for me, haven't returned the results I expected.</p>
<p>Of course, if you standard analyzers won't be what you seek, there's always an
option to define custom analyzers, custom tokenizers, and custom filters.</p>
    
        <ul class="pager hidden-print">
<li class="previous">
                <a href="../pylama-python-developers-helpful-companion/" rel="prev" title="Pylama - Python developer's helpful companion">Previous post</a>
            </li>
            <li class="next">
                <a href="../testing-web-applications-using-sqlalchemy/" rel="next" title="Testing web applications using SQLAlchemy.">Next post</a>
            </li>
        </ul>
<div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="casesblog",
            disqus_url="https://fizyk.dev/blog/elasticsearch-analyzers/",
        disqus_title="Elasticsearch analyzers",
        disqus_identifier="cache/posts/2014-03-11-elasticsearch-analyzers.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


    

    </div>

        </div>
        <div id="sidebar">
            <!--Sidebar content-->
            <h1 id="blog-title">
                <a href="https://fizyk.dev/" title="Cases">Cases</a>
            </h1>
            
            <small>
                Also available in: 
                
            <li><a href="https://fizyk.dev/pl/" rel="alternate" hreflang="pl">Polski</a></li>

            </small>
            
            <ul class="unstyled">
<li>
<a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.pl">
    <img alt="Licencja Creative Commons" style="border-width:0" src="http://i.creativecommons.org/l/by/3.0/88x31.png"></a>
<br>Ten utwór, autorstwa
<span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">
    Grzegorz Śliwiński</span>
jest dostępny na licencji
<a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.pl">
    Creative Commons Uznanie autorstwa 3.0 Unported
</a>.</li>
            
                <li>
<a href="https://fizyk.dev/en">Homepage</a>
                </li>
<li>
<a href="../../archive/">Archives</a>
                </li>
<li>
<a href="../../tags/">Tags</a>

            </li>
<li>
            
            
            </ul>
</div>
        <div id="footer">
            Contents © 2025 <a href="mailto:fizyk~~fizyk.dev">Grzegorz Śliwiński</a> - Powered by <a href="http://nikola.ralsina.com.ar">Nikola</a>
            
        </div>
    </div>
    
            <script src="../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-20536007-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>
