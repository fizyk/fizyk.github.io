<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Measuring test coverage of py.test plugins | Cases</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" hreflang="en" href="../../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (pl)" hreflang="pl" href="../../pl/rss.xml">
<link rel="canonical" href="http://blog.fizyk.net.pl/blog/measuring-test-coverage-of-pytest-plugins/">
<link rel="icon" href="../../favicon.png" sizes="62x60">
<link rel="icon" href="../../favicon-speddial.png" sizes="269x262">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Grzegorz Śliwiński">
<link rel="prev" href="../pytest-dbfixtures-now-works-with-python-3/" title="pytest-dbfixtures now works with python 3" type="text/html">
<link rel="next" href="../creating-a-timestamp-in-python-difference-between-calendartimegm-and-timemktime/" title="Creating a timestamp in python - difference between calendar.timegm and time.mktime" type="text/html">
<meta property="og:site_name" content="Cases">
<meta property="og:title" content="Measuring test coverage of py.test plugins">
<meta property="og:url" content="http://blog.fizyk.net.pl/blog/measuring-test-coverage-of-pytest-plugins/">
<meta property="og:description" content="Measuring your code's test coverage is important, though not definitive metric
to tell that Your code is well tested. But to measure coverage properly, tests
have to be properly initialized as well. A">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2014-11-16T16:54:42+01:00">
<meta property="article:tag" content="coverage">
<meta property="article:tag" content="pytest">
<meta property="article:tag" content="python">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Header and menu bar -->
<div class="container">
      <header class="blog-header py-3"><div class="row nbb-header align-items-center">
          <div class="col-md-3 col-xs-2 col-sm-2" style="width: auto;">
            <button class="navbar-toggler navbar-light bg-light nbb-navbar-toggler" type="button" data-toggle="collapse" data-target=".bs-nav-collapsible" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse bs-nav-collapsible bootblog4-search-form-holder">
                
            </div>
        </div>
          <div class="col-md-6 col-xs-10 col-sm-10 bootblog4-brand" style="width: auto;">
            <a class="navbar-brand blog-header-logo text-dark" href="../../">

            <span id="blog-title">Cases</span>
        </a>
          </div>
            <div class="col-md-3 justify-content-end align-items-center bs-nav-collapsible collapse flex-collapse bootblog4-right-nav">
            <nav class="navbar navbar-light bg-white"><ul class="navbar-nav bootblog4-right-nav">
<li class="nav-item"><a href="../../pl/" rel="alternate" hreflang="pl" class="nav-link">Polski</a></li>

                    
                    
    
    <li class="nav-item">
    <a href="index.rst" id="sourcelink" class="nav-link">Source</a>
    </li>


                    
            </ul></nav>
</div>
    </div>
</header><nav class="navbar navbar-expand-md navbar-light bg-white static-top"><div class="collapse navbar-collapse bs-nav-collapsible" id="bs-navbar">
            <ul class="navbar-nav nav-fill d-flex w-100">
<li class="nav-item">
<a href="http://www.fizyk.net.pl/en" class="nav-link">Homepage</a>
                </li>
<li class="nav-item">
<a href="../../archive/" class="nav-link">Archives</a>
                </li>
<li class="nav-item">
<a href="../../tags/" class="nav-link">Tags</a>

                
            </li>
</ul>
</div>
<!-- /.navbar-collapse -->
</nav>
</div>

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Measuring test coverage of py.test plugins</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Grzegorz Śliwiński
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2014-11-16T16:54:42+01:00" itemprop="datePublished" title="16 11 2014 16:54">16 11 2014 16:54</time></a>
            </p>
                <p class="commentline">
        
    <a href="#disqus_thread" data-disqus-identifier="cache/posts/2014-11-16-measuring-test-coverage-of-pytest-plugins.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="index.rst" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p>Measuring your code's test coverage is important, though not definitive metric
to tell that Your code is well tested. But to measure coverage properly, tests
have to be properly initialized as well. And today I asked myself a question,
how do I measure properly test coverage of <a class="reference external" href="http://pytest.org/">py.test</a>
plugins?</p>
<!-- TEASER_END -->
<p>Py.test plugins are quite tricky, because they get initialized on test session
start, that is even before coverage will kick in - even though
<a class="reference external" href="https://pypi.python.org/pypi/pytest-cov">pytest-cov</a> since version 1.7 it
kicks in in exact moment, thanks to a pytest_sessionstart hook.</p>
<p>And just today, I was toying with the idea looking first at recent changes in
pytest-cov, and it occurred to me, that to get full coverage of pytest plugin,
I actually have to turn it off!</p>
<pre class="code text"><a id="rest_code_145c566e2e544e028b9e34f46402f4f2-1" name="rest_code_145c566e2e544e028b9e34f46402f4f2-1"></a>py.test -p no:pytest-plugin
</pre>
<p>But how do we use plguin's fixtures and configuration then? Well, it's enough
to import everything from the plugin in test's <em>conftest.py</em> file!</p>
<pre class="code python"><a id="rest_code_d9aaaf41423047f0918d19c6245953a1-1" name="rest_code_d9aaaf41423047f0918d19c6245953a1-1"></a><span class="kn">from</span> <span class="nn">pytest_plugin.plugin</span> <span class="kn">import</span> <span class="o">*</span>
</pre>
<p>This will make your plugin's fixture to kick in, as well as any configuration
option your pytest plugin might require.</p>
<p>Results can be seen on <a class="reference external" href="https://coveralls.io/">coveralls.io</a> for both plugins
I contribute to:
<a class="reference external" href="https://coveralls.io/builds/1481408">pytest-dbfixtures</a> and
<a class="reference external" href="https://coveralls.io/builds/1481430">pytest_pyramid</a></p>
<p>Of course, code coverage can tell you only, what percentage of code has been
touched by tests. Not if it is properly tested!</p>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../tags/coverage/" rel="tag">coverage</a></li>
            <li><a class="tag p-category" href="../../tags/pytest/" rel="tag">pytest</a></li>
            <li><a class="tag p-category" href="../../tags/python/" rel="tag">python</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../pytest-dbfixtures-now-works-with-python-3/" rel="prev" title="pytest-dbfixtures now works with python 3">Previous post</a>
            </li>
            <li class="next">
                <a href="../creating-a-timestamp-in-python-difference-between-calendartimegm-and-timemktime/" rel="next" title="Creating a timestamp in python - difference between calendar.timegm and time.mktime">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="casesblog",
            disqus_url="http://blog.fizyk.net.pl/blog/measuring-test-coverage-of-pytest-plugins/",
        disqus_title="Measuring test coverage of py.test plugins",
        disqus_identifier="cache/posts/2014-11-16-measuring-test-coverage-of-pytest-plugins.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="casesblog";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><!--End of body content--><footer id="footer">
            Contents © 2021 <a href="mailto:fizyk~~fizyk.net.pl">Grzegorz Śliwiński</a> - Powered by <a href="http://nikola.ralsina.com.ar">Nikola</a>
            
            
        </footer>
</div>
</div>


        <script src="../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-20536007-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>
