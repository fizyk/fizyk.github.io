<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Measuring test coverage of py.test plugins | Cases</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="../../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (pl)" href="../../pl/rss.xml">
<link rel="canonical" href="https://fizyk.dev/blog/measuring-test-coverage-of-pytest-plugins/">
<link rel="icon" href="../../favicon-speddial.png" sizes="269x262">
<link rel="icon" href="../../favicon.png" sizes="62x60">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]-->
</head>
<body class="home blog">
    <div id="wrap" style="width:850px">
        <div id="container" style="width:560px">
            
            
    <div class="post">
    
    <h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Measuring test coverage of py.test plugins</a></h1>

        <div class="meta" style="background-color: rgb(234, 234, 234); ">
        <span class="authordate">
            Posted: <time class="published" datetime="2014-11-16T16:54:42+01:00">16 11 2014 16:54</time>
               [<a href="index.rst" id="sourcelink">Source</a>]
        </span>
        <br><span class="tags">Tags: 
                    <a class="tag" href="../../tags/coverage/"><span>coverage</span></a>
                    <a class="tag" href="../../tags/pytest/"><span>pytest</span></a>
                    <a class="tag" href="../../tags/python/"><span>python</span></a>
                </span>
                <br><span class="authordate">
            

        </span>
        </div>
    <p>Measuring your code's test coverage is important, though not definitive metric
to tell that Your code is well tested. But to measure coverage properly, tests
have to be properly initialized as well. And today I asked myself a question,
how do I measure properly test coverage of <a class="reference external" href="http://pytest.org/">py.test</a>
plugins?</p>
<!-- TEASER_END -->
<p>Py.test plugins are quite tricky, because they get initialized on test session
start, that is even before coverage will kick in - even though
<a class="reference external" href="https://pypi.python.org/pypi/pytest-cov">pytest-cov</a> since version 1.7 it
kicks in in exact moment, thanks to a pytest_sessionstart hook.</p>
<p>And just today, I was toying with the idea looking first at recent changes in
pytest-cov, and it occurred to me, that to get full coverage of pytest plugin,
I actually have to turn it off!</p>
<div class="code"><pre class="code text"><a id="rest_code_7f56511b7e4243d5aef0c7db797e8ea3-1" name="rest_code_7f56511b7e4243d5aef0c7db797e8ea3-1" href="#rest_code_7f56511b7e4243d5aef0c7db797e8ea3-1"></a>py.test -p no:pytest-plugin
</pre></div>
<p>But how do we use plguin's fixtures and configuration then? Well, it's enough
to import everything from the plugin in test's <em>conftest.py</em> file!</p>
<div class="code"><pre class="code python"><a id="rest_code_926566dc5f4b450fa200f1d020155fe5-1" name="rest_code_926566dc5f4b450fa200f1d020155fe5-1" href="#rest_code_926566dc5f4b450fa200f1d020155fe5-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pytest_plugin.plugin</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</pre></div>
<p>This will make your plugin's fixture to kick in, as well as any configuration
option your pytest plugin might require.</p>
<p>Results can be seen on <a class="reference external" href="https://coveralls.io/">coveralls.io</a> for both plugins
I contribute to:
<a class="reference external" href="https://coveralls.io/builds/1481408">pytest-dbfixtures</a> and
<a class="reference external" href="https://coveralls.io/builds/1481430">pytest_pyramid</a></p>
<p>Of course, code coverage can tell you only, what percentage of code has been
touched by tests. Not if it is properly tested!</p>
    
        <ul class="pager hidden-print">
<li class="previous">
                <a href="../pytest-dbfixtures-now-works-with-python-3/" rel="prev" title="pytest-dbfixtures now works with python 3">Previous post</a>
            </li>
            <li class="next">
                <a href="../creating-a-timestamp-in-python-difference-between-calendartimegm-and-timemktime/" rel="next" title="Creating a timestamp in python - difference between calendar.timegm and time.mktime">Next post</a>
            </li>
        </ul>
<div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="casesblog",
            disqus_url="https://fizyk.dev/blog/measuring-test-coverage-of-pytest-plugins/",
        disqus_title="Measuring test coverage of py.test plugins",
        disqus_identifier="cache/posts/2014-11-16-measuring-test-coverage-of-pytest-plugins.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


    

    </div>

        </div>
        <div id="sidebar">
            <!--Sidebar content-->
            <h1 id="blog-title">
                <a href="https://fizyk.dev/" title="Cases">Cases</a>
            </h1>
            
            <small>
                Also available in: 
                
            <li><a href="https://fizyk.dev/pl/" rel="alternate" hreflang="pl">Polski</a></li>

            </small>
            
            <ul class="unstyled">
<li>
<a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.pl">
    <img alt="Licencja Creative Commons" style="border-width:0" src="http://i.creativecommons.org/l/by/3.0/88x31.png"></a>
<br>Ten utwór, autorstwa
<span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">
    Grzegorz Śliwiński</span>
jest dostępny na licencji
<a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.pl">
    Creative Commons Uznanie autorstwa 3.0 Unported
</a>.</li>
            
                <li>
<a href="https://fizyk.dev/en">Homepage</a>
                </li>
<li>
<a href="../../archive/">Archives</a>
                </li>
<li>
<a href="../../tags/">Tags</a>

            </li>
<li>
            
            
            </ul>
</div>
        <div id="footer">
            Contents © 2025 <a href="mailto:fizyk~~fizyk.dev">Grzegorz Śliwiński</a> - Powered by <a href="http://nikola.ralsina.com.ar">Nikola</a>
            
        </div>
    </div>
    
            <script src="../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-20536007-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>
